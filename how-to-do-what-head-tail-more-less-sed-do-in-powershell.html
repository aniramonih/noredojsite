<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="GleamBlog"><meta property="og:type" content="article"><meta name=robots content="index,follow,noarchive"><meta property="og:image" content="//img/home-bg-jeep.jpg"><meta property="twitter:image" content="//img/home-bg-jeep.jpg"><meta name=title content="How to do what head, tail, more, less, sed do in Powershell? [closed]"><meta property="og:title" content="How to do what head, tail, more, less, sed do in Powershell? [closed]"><meta property="twitter:title" content="How to do what head, tail, more, less, sed do in Powershell? [closed]"><meta name=description content="On windows, using Powershell, what are the equivalent commands to linux's head, tail, more, less and sed? Get-Content (alias: gc) is your usual option for reading a text file. You can then filter further:"><meta property="og:description" content="On windows, using Powershell, what are the equivalent commands to linux's head, tail, more, less and sed? Get-Content (alias: gc) is your usual option for reading a text file. You can then filter further:"><meta property="twitter:description" content="On windows, using Powershell, what are the equivalent commands to linux's head, tail, more, less and sed? Get-Content (alias: gc) is your usual option for reading a text file. You can then filter further:"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=./img/favicon.ico><title>How to do what head, tail, more, less, sed do in Powershell? [closed] |</title><link rel=canonical href=./how-to-do-what-head-tail-more-less-sed-do-in-powershell.html><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/bootstrap.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/bootstrap.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/hux-blog.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=./>GleamBlog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=./categories/post>post</a></li><li><a href=./sitemap.xml>Sitemap</a></li><li><a href=./index.xml>RSS</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg-jeep.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>How to do what head, tail, more, less, sed do in Powershell? [closed]</h1><h2 class=subheading></h2><span class=meta>Posted by
Kelle Repass
on
Wednesday, August 7, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><img src=https://cdn.statically.io/img/cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><p>On windows, using Powershell, what are the equivalent commands to linux's <code>head</code>, <code>tail</code>, <code>more</code>, <code>less</code> and <code>sed</code>?</p><span class=d-none itemprop=commentCount>4</span><h2 class=mb0 data-answercount=7>7 Answers</h2><p><code>Get-Content</code> (alias: <code>gc</code>) is your usual option for reading a text file. You can then filter further:</p><pre><code>gc log.txt | select -first 10 # head gc -TotalCount 10 log.txt # also head gc log.txt | select -last 10 # tail gc -Tail 10 log.txt # also tail (since PSv3), also much faster than above option gc log.txt | more # or less if you have it installed gc log.txt | %{ $_ -replace '\d+', '($0)' } # sed </code></pre><p>This works well enough for small files, larger ones (more than a few MiB) are probably a bit slow.</p><p>The <a href=# rel=noreferrer>PowerShell Community Extensions</a> include some cmdlets for specialised file stuff (e.g. Get-FileTail).</p><span class=d-none itemprop=commentCount>11</span><p>Here are the built-in ways to do <code>head</code> and <code>tail</code>. Don't use pipes because if you have a large file, it will be extremely slow. Using these built-in options will be extremely fast even for huge files.</p><pre><code>gc log.txt -head 10 gc log.txt -tail 10 gc log.txt -tail 10 -wait # equivalent to tail -f </code></pre><span class=d-none itemprop=commentCount>4</span><p><code>more.exe</code> exists on Windows, ports of <code>less</code> are easily found (and the <a href=#>PowerShell Community Extensions</a>, PSCX, includes one).</p><p>PowerShell doesn't really provide any alternative to separate programs for either, but for structured data <code>Out-Grid</code> can be helpful.</p><p><code>Head</code> and <code>Tail</code> can both be emulated with <code>Select-Object</code> using the <code>-First</code> and <code>-Last</code> parameters respectively.</p><p><code>Sed</code> functions are all available but structured rather differently. The filtering options are available in <code>Where-Object</code> (or via <code>Foreach-Object</code> and some state for ranges). Other, transforming, operations can be done with <code>Select-Object</code> and <code>Foreach-Object</code>.</p><p>However as PowerShell passes (.NET) objects – with all their typed structure, eg. dates remain <code>DateTime</code> instances – rather than just strings, which each command needs to parse itself, much of <code>sed</code> and other such programs are redundant.</p><span class=d-none itemprop=commentCount>1</span><p>"-TotalCount" in this instance responds exactly like "-head". You have to use -TotalCount or -head to run the command like that. But -TotalCount is misleading - it does not work in ACTUALLY giving you ANY counts...</p><pre><code>gc -TotalCount 25 C:\scripts\logs\robocopy_report.txt </code></pre><p>The above script, tested in PS 5.1 is the SAME response as below...</p><pre><code>gc -head 25 C:\scripts\logs\robocopy_report.txt </code></pre><p>So then just use '-head 25" already!</p><span class=d-none itemprop=commentCount>1</span><p>If you need to query large (or small) log files on Windows, the best tool I have found is Microsoft's free <a href=# rel=nofollow>Log Parser 2.2</a>. You can call it from PowerShell if you want and it will do all the heavy lifting for you, and very fast too.</p><span class=d-none itemprop=commentCount>2</span><p>I got some better solutions:</p><pre><code>gc log.txt -ReadCount 5 | %{$_;throw "pipeline end!"} # head gc log.txt | %{$num=0;}{$num++;"$num $_"} # cat -n gc log.txt | %{$num=0;}{$num++; if($num -gt 2 -and $num -lt 7){"$num $_"}} # sed </code></pre><span class=d-none itemprop=commentCount></span><pre><code>$Push_Pop = $ErrorActionPreference #Suppresses errors $ErrorActionPreference = “SilentlyContinue” #Suppresses errors #Script #gc .\output\*.csv -ReadCount 5 | %{$_;throw "pipeline end!"} # head #gc .\output\*.csv | %{$num=0;}{$num++;"$num $_"} # cat -n gc .\output\*.csv | %{$num=0;}{$num++; if($num -gt 2 -and $num -lt 7){"$num $_"}} # sed #End Script $ErrorActionPreference = $Push_Pop #Suppresses errors </code></pre><p>You don't get all the errors with the pushpop code BTW, your code only works with the "sed" option. All the rest ignores anything but gc and path.</p><span class=d-none itemprop=commentCount>1</span><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmirpJawrLvVnqmfpJ%2Bse6S7zGiorp2jqbawutJocG9wYmV%2FdXvHqK5mrJ9isbB51qGYrWWYmq6ledOaoKVlnaS%2FpnnLnqqsZaOasW6wzmagp2WgpMSmvtKhnKWk</p><hr><ul class=pager><li class=previous><a href=./varun-chakravarthy-wife-kkr.html data-toggle=tooltip data-placement=top title="Inside KKR Player Varun Chakravarthys Married Life with Wife Neha Khedekar">&larr;
Previous Post</a></li><li class=next><a href=./how-did-zach-bryan-lose-his-mom-country-singers-wife-elisabeth-and-divorce-449163-html.html data-toggle=tooltip data-placement=top title="How Did Zach Bryan Lose His Mom? Country Singers Wife Elisabeth and Divorce">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=./tags/>FEATURED TAGS</a></h5><div class=tags></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"></ul><p class="copyright text-muted">Copyright &copy; GleamBlog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(i,t){var n=document,s="script",e=n.createElement(s),o=n.getElementsByTagName(s)[0];e.src=i,t&&e.addEventListener("load",function(e){t(null,e)},!1),o.parentNode.insertBefore(e,o)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(''),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/tracking_server_3.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>